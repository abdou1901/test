#include <stdio.h>\n#include <stdint.h>\n\nint main(){\n    int t;\n    scanf("%d", &t);\n    while(t--){\n        int n;\n        scanf("%d", &n);\n        char opL[35], opR[35];\n        int A[35], B[35];\n        for (int i = 0; i < n; i++){\n            scanf(" %c %d %c %d", &opL[i], &A[i], &opR[i], &B[i]);\n        }\n        int64_t c = 1, d = 1, e = 0;\n        for (int i = n-1; i >= 0; i--){\n            char leftOp = opL[i], rightOp = opR[i];\n            int a = A[i], b = B[i];\n            if (c >= d) {\n                int64_t newC=c*(leftOp == 'x' ? a : 1);\n                int64_t newD=d+c*(rightOp == 'x' ? (b - 1) : 0);\n                int64_t newE = e+c*(leftOp == '+' ? a : 0) + c * (rightOp == '+' ? b : 0);\n                c = newC;d= newD; e = newE;\n            } else {\n                int64_t newC=c+d*(leftOp == 'x' ? (a - 1) : 0);\n                int64_t newD =d* (rightOp == 'x' ? b : 1);\n                int64_t newE =e+d*(leftOp == '+' ? a : 0) + d * (rightOp == '+' ? b : 0);\n                c = newC;d =newD;e = newE;\n            }\n        }\n        int64_t ans = c + d + e;\n        printf("%lld\n", ans);\n    }\n    return 0;\n}